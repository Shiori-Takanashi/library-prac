
### 🧠 練習問題：図書館貸出システムの設計と実装

#### 📌 問題概要

あなたは、**図書館の貸出管理システム**をPythonで実装する担当となりました。
以下の要件を満たすシステムを、**複数のクラスで構成し、オブジェクト指向設計**に基づいて構築してください。

---

#### 🔧 要件

1. **図書館には複数の図書（Book）と利用者（User）が存在する。**
2. 各図書には、タイトル・著者・ISBN・蔵書数があり、貸出中であればその数が減る。
3. 各利用者は、ID・氏名・貸出履歴・現在借りている図書の一覧を持つ。
4. 図書館（Library）クラスは、図書と利用者の管理を行う。
5. 以下の操作が可能であること：

   * 図書の追加・削除
   * 利用者の登録・削除
   * 図書の貸出（User → Book）
   * 図書の返却（User ← Book）
   * 現在の図書一覧と在庫表示
   * 特定の利用者の貸出履歴表示

---

#### 🧱 実装条件

* `Book`, `User`, `Library` の3つ以上のクラスを使うこと。
* 貸出時に在庫がない場合は例外を発生させる。
* 返却時に借りていない本を返すことはできない（例外）。
* `Library` クラスは、図書と利用者の登録・検索を管理する中心クラスとする。
* 型ヒントを使用すること。
* クラスを整理する場合、`library.py`, `book.py`, `user.py` などに分けてもよい（設計重視）。
* 任意で JSON ファイルへのデータ保存・読み込み機能を追加してもよい。

---

#### 🏗 発展課題（任意）

* 複数の図書館（Library）を運営し、図書の移動や貸出履歴の共有を可能にせよ。
* 図書にジャンルを持たせ、ジャンルごとの貸出ランキングを表示せよ。
* 利用者にログイン/ログアウト機能を持たせ、セッション管理を模擬せよ。
* ユーザーの種類（一般/職員）を抽象クラスで表現し、操作権限を分けよ。
* コマンドライン引数や`click`等を使ってCLI操作可能にせよ。

---

#### 💡 実装ヒント

* クラス間の責務を明確にする（Bookは自身の貸出状況しか知らない / Userは自身の履歴を管理する / Libraryが全体統括）。
* 内部状態をなるべくprivateにし、`@property`などで操作を制御する。
* 例外クラスを自作すると堅牢性が高まる。

---
